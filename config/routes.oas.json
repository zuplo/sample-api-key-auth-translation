{
  "openapi": "3.1.0",
  "info": {
    "version": "1.0.0",
    "title": "Sample API Key Translation Service"
  },
  "paths": {
    "/consumers/my": {
      "get": {
        "summary": "Get my consumers",
        "x-zuplo-route": {
          "corsPolicy": "anything-goes",
          "handler": {
            "export": "urlRewriteHandler",
            "module": "$import(@zuplo/runtime)",
            "options": {
              "rewritePattern": "${env.BUCKET_URL}/consumers/?include-api-keys=true&key-format=visible&tag.orgId=${request.user.data.orgId}"
            }
          },
          "policies": {
            "inbound": [
              "auth0-jwt-auth-inbound",
              "set-user-org",
              "add-zapi-key-auth"
            ],
            "outbound": []
          }
        },
        "operationId": "d86ecbdc-2aa7-4bd0-9e61-4245ecd1d5cd"
      }
    },
    "/consumers/{consumerName}/roll": {
      "post": {
        "summary": "Roll consumer key",
        "x-zuplo-route": {
          "corsPolicy": "anything-goes",
          "handler": {
            "export": "roll",
            "module": "$import(./modules/roll-key)",
            "options": {}
          },
          "policies": {
            "inbound": ["auth0-jwt-auth-inbound", "verify-consumer-access"]
          }
        },
        "operationId": "f73c7996-b6bc-48b8-815b-ead885d723ed"
      }
    },
    "/consumers/{consumerName} ": {
      "patch": {
        "summary": "Update consumer",
        "x-zuplo-route": {
          "corsPolicy": "anything-goes",
          "handler": {
            "export": "urlRewriteHandler",
            "module": "$import(@zuplo/runtime)",
            "options": {
              "rewritePattern": "${env.BUCKET_URL}/consumers/${params.consumerName}"
            }
          },
          "policies": {
            "inbound": [
              "auth0-jwt-auth-inbound",
              "verify-consumer-access",
              "add-zapi-key-auth"
            ],
            "outbound": ["set-status-outbound"]
          }
        },
        "operationId": "84960874-662e-4454-ae3f-5f53611ba072"
      }
    },
    "/consumers/{consumerName}/keys/{keyId}": {
      "delete": {
        "summary": "Delete key",
        "x-zuplo-route": {
          "corsPolicy": "anything-goes",
          "handler": {
            "export": "urlRewriteHandler",
            "module": "$import(@zuplo/runtime)",
            "options": {
              "rewritePattern": "${env.BUCKET_URL}/consumers/${params.consumerName}/keys/${params.keyId}"
            }
          },
          "policies": {
            "inbound": [
              "auth0-jwt-auth-inbound",
              "verify-consumer-access",
              "verify-key-in-consumer",
              "add-zapi-key-auth"
            ]
          }
        },
        "operationId": "fa92d9f2-3d03-48e9-b475-19206b52f64a"
      }
    }
  }
}
